/*! lg-video - v1.1.0 - 2017-08-08
* MODIFIED BY PRN FOR KALTURA
* http://sachinchoolur.github.io/lightGallery
* Copyright (c) 2016 Sachin N; Licensed GPLv3 */
!function(){"use strict";var e={videoMaxWidth:"855px",youtubePlayerParams:!1,vimeoPlayerParams:!1,dailymotionPlayerParams:!1,vkPlayerParams:!1,videojs:!1,videojsOptions:{}},o=function(o){return this.core=$(o).data("lightGallery"),this.$el=$(o),this.core.s=$.extend({},e,this.core.s),this.videoLoaded=!1,this.init(),this};o.prototype.init=function(){var e=this;e.core.$el.on("hasVideo.lg.tm",function(o,i,a,l){if(e.core.$slide.eq(i).find(".lg-video").append(e.loadVideo(a,"lg-object",!0,i,l)),l)if(e.core.s.videojs)try{videojs(e.core.$slide.eq(i).find(".lg-html5").get(0),e.core.s.videojsOptions,function(){e.videoLoaded||this.play()})}catch(e){console.error("Make sure you have included videojs")}else e.core.$slide.eq(i).find(".lg-kaltura")?e.core.$slide.eq(i).find(".lg-video").addClass("lg-kaltura-video"):e.videoLoaded||e.core.$slide.eq(i).find(".lg-html5").get(0).play()}),e.core.$el.on("onAferAppendSlide.lg.tm",function(o,i){var a=e.core.$slide.eq(i).find(".lg-video-cont");a.hasClass("lg-has-iframe")||(a.css("max-width",e.core.s.videoMaxWidth),e.videoLoaded=!0)});var o=function(o){if(o.find(".lg-object").hasClass("lg-has-poster")&&o.find(".lg-object").is(":visible"))if(o.hasClass("lg-has-video")){var i=o.find(".lg-youtube").get(0),a=o.find(".lg-vimeo").get(0),l=o.find(".lg-dailymotion").get(0),s=o.find(".lg-html5").get(0);if(i)i.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*");else if(a)try{$f(a).api("play")}catch(e){console.error("Make sure you have included froogaloop2 js")}else if(l)l.contentWindow.postMessage("play","*");else if(s)if(e.core.s.videojs)try{videojs(s).play()}catch(e){console.error("Make sure you have included videojs")}else s.play();o.addClass("lg-video-playing")}else{o.addClass("lg-video-playing lg-has-video");var r=function(i,a){if(o.find(".lg-video").append(e.loadVideo(i,"",!1,e.core.index,a)),a)if(e.core.s.videojs)try{videojs(e.core.$slide.eq(e.core.index).find(".lg-html5").get(0),e.core.s.videojsOptions,function(){this.play()})}catch(e){console.error("Make sure you have included videojs")}else e.core.$slide.eq(e.core.index).find(".lg-html5").get(0).play()};e.core.s.dynamic?r(e.core.s.dynamicEl[e.core.index].src,e.core.s.dynamicEl[e.core.index].html):r(e.core.$items.eq(e.core.index).attr("href")||e.core.$items.eq(e.core.index).attr("data-src"),e.core.$items.eq(e.core.index).attr("data-html"));var t=o.find(".lg-object");o.find(".lg-video").append(t),o.find(".lg-video-object").hasClass("lg-html5")||(o.removeClass("lg-complete"),o.find(".lg-video-object").on("load.lg error.lg",function(){o.addClass("lg-complete")}))}};e.core.doCss()&&e.core.$items.length>1&&(e.core.s.enableSwipe||e.core.s.enableDrag)?e.core.$el.on("onSlideClick.lg.tm",function(){var i=e.core.$slide.eq(e.core.index);o(i)}):e.core.$slide.on("click.lg",function(){o($(this))}),e.core.$el.on("onBeforeSlide.lg.tm",function(o,i,a){var l=e.core.$slide.eq(i),s=l.find(".lg-youtube").get(0),r=l.find(".lg-vimeo").get(0),t=l.find(".lg-dailymotion").get(0),d=l.find(".lg-vk").get(0),c=l.find(".lg-html5").get(0);l.find(".lg-kaltura-video").get(0);if(s)s.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");else if(r)try{$f(r).api("pause")}catch(e){console.error("Make sure you have included froogaloop2 js")}else if(t)t.contentWindow.postMessage("pause","*");else if(c)if(e.core.s.videojs)try{videojs(c).pause()}catch(e){console.error("Make sure you have included videojs")}else c.pause();d&&$(d).attr("src",$(d).attr("src").replace("&autoplay","&noplay"));var n;n=e.core.s.dynamic?e.core.s.dynamicEl[a].src:e.core.$items.eq(a).attr("href")||e.core.$items.eq(a).attr("data-src");var m=e.core.isVideo(n,a)||{};(m.youtube||m.vimeo||m.dailymotion||m.vk)&&e.core.$outer.addClass("lg-hide-download")}),e.core.$el.on("onAfterSlide.lg.tm",function(o,i){e.core.$slide.eq(i).removeClass("lg-video-playing")})},o.prototype.loadVideo=function(e,o,i,a,l){var s="",r=1,t="",d=this.core.isVideo(e,a)||{};if(i&&(r=this.videoLoaded?0:1),d.youtube)t="?wmode=opaque&autoplay="+r+"&enablejsapi=1",this.core.s.youtubePlayerParams&&(t=t+"&"+$.param(this.core.s.youtubePlayerParams)),s='<iframe class="lg-video-object lg-youtube '+o+'" width="560" height="315" src="//www.youtube.com/embed/'+d.youtube[1]+t+'" frameborder="0" allowfullscreen></iframe>';else if(d.vimeo)t="?autoplay="+r+"&api=1",this.core.s.vimeoPlayerParams&&(t=t+"&"+$.param(this.core.s.vimeoPlayerParams)),s='<iframe class="lg-video-object lg-vimeo '+o+'" width="560" height="315"  src="//player.vimeo.com/video/'+d.vimeo[1]+t+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';else if(d.dailymotion)t="?wmode=opaque&autoplay="+r+"&api=postMessage",this.core.s.dailymotionPlayerParams&&(t=t+"&"+$.param(this.core.s.dailymotionPlayerParams)),s='<iframe class="lg-video-object lg-dailymotion '+o+'" width="560" height="315" src="//www.dailymotion.com/embed/video/'+d.dailymotion[1]+t+'" frameborder="0" allowfullscreen></iframe>';else if(d.kaltura)"."!==(c=l.substring(0,1))&&"#"!==c||(l=$(l).html()),s=l=l.slice(0,l.indexOf('class="video-wrap"'))+'id="lg-kaltura-video-'+a+'" '+l.slice(l.indexOf('class="video-wrap"'));else if(d.html5){var c=l.substring(0,1);"."!==c&&"#"!==c||(l=$(l).html()),s=l}else d.vk&&(t="&autoplay="+r,this.core.s.vkPlayerParams&&(t=t+"&"+$.param(this.core.s.vkPlayerParams)),s='<iframe class="lg-video-object lg-vk '+o+'" width="560" height="315" src="http://vk.com/video_ext.php?'+d.vk[1]+t+'" frameborder="0" allowfullscreen></iframe>');return s},o.prototype.destroy=function(){this.videoLoaded=!1},$.fn.lightGallery.modules.video=o}();