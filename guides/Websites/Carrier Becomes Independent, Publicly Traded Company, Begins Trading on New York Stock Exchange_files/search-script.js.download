define(['jquery'],function($){function escapeHTML(str){str=str.replace(new RegExp("&","g"),"&amp;");str=str.replace(new RegExp("<","g"),"&lt;");str=str.replace(new RegExp(">","g"),"&gt;");str=str.replace(new RegExp("\"","g"),"&quot;");return str;}
$("#site-search-button").click(function(){var searchtxt=$("#sitesearchbox").val();var searchUrl=$("#sitesearchurl").val();window.location.href=escapeHTML(searchUrl)+'?keyword='+encodeURIComponent(searchtxt);return false;});$('#sitesearchbox').keyup(function(event){if($("#enableQuickSearch").val()=='false'){$('.qs-pending').hide();}
$('.qs-no-results').hide();if(!event.ctrlKey){if(event.keyCode==13){var searchtxt=$("#sitesearchbox").val();var searchUrl=$("#sitesearchurl").val();window.location.href=escapeHTML(searchUrl)+'?keyword='+encodeURIComponent(searchtxt);return false;}else if(event.which==8&&this.value.length>1){var searchTxt=$("#sitesearchbox").val();var siteVal=$("#siteValue").val();var langVal=$("#langValue").val();doSearch(encodeURIComponent(searchTxt),siteVal,langVal);}else if($("#enableQuickSearch").val()=='true'&&this.value.length>1){var searchTxt=$("#sitesearchbox").val();var siteVal=$("#siteValue").val();var langVal=$("#langValue").val();doSearch(encodeURIComponent(searchTxt),siteVal,langVal);}}});doSearch=function(searchTxt,siteVal,langVal){$.ajax({type:'GET',url:"/bin/prnewswire/prnTypeaheadService.html",dataType:"json",data:{keyword:searchTxt,sitekey:siteVal,lang:langVal},contentType:"application/json; charset=utf-8",dataType:"json",async:true,cache:false,success:function(msg){$('.qs-pending').hide();$('.qs-no-results').hide();var newsFlag=false;var prodFlag=false;var orgFlag=false;var viewAllorglabelHtml=siteSearchProperties.viewAllorglabelHtml!=null&&siteSearchProperties.viewAllorglabelHtml!='undefined'&&siteSearchProperties.viewAllorglabelHtml!=''?siteSearchProperties.viewAllorglabelHtml:"Organisations <span>view all</span>";var viewAllprodlabelHtml=siteSearchProperties.viewAllprodlabelHtml!=null&&siteSearchProperties.viewAllprodlabelHtml!='undefined'&&siteSearchProperties.viewAllprodlabelHtml!=''?siteSearchProperties.viewAllprodlabelHtml:"Products <span>view all</span>";var viewAllresourcelabelHtml=siteSearchProperties.viewAllresourcelabelHtml!=null&&siteSearchProperties.viewAllresourcelabelHtml!='undefined'&&siteSearchProperties.viewAllresourcelabelHtml!=''?siteSearchProperties.viewAllresourcelabelHtml:"Resources <span>view all</span>";var newsReleasePrefix=siteSearchProperties.newsReleasePrefix!=null&&siteSearchProperties.newsReleasePrefix!='undefined'&&siteSearchProperties.newsReleasePrefix!=''?siteSearchProperties.newsReleasePrefix:"/news-releases/";var viewAllNewslabelHtml=siteSearchProperties.viewAllNewslabelHtml!=null&&siteSearchProperties.viewAllNewslabelHtml!='undefined'&&siteSearchProperties.viewAllNewslabelHtml!=''?siteSearchProperties.viewAllNewslabelHtml:"News Releases <span>view all</span>";$("#eraResponseJson").empty();var ul;if(msg.result.release.hits!=null&&msg.result.release.hits.length>0){ul=$('<ul>');ul.append('<a href="'+escapeHTML($("#allnewssearchurl").val())+'?keyword='+encodeURIComponent($("#sitesearchbox").val())+'"><li class="qs-filter" data-filter="news"><h2>'+viewAllNewslabelHtml+'</h2></li></a>');$.each(msg.result.release.hits,function(key,values){ul.append('<li><a href="'+newsReleasePrefix+splitNewReleaseUrl(values._source.url)+'.html">'+values._source.title+'</a></li>');});$("#eraResponseJson").append(ul);$("#eraResponseJson").append('<div class="qs-skip container-fluid"><hr /></div>');newsFlag=true;}
if(msg.result.static.hits!=null&&msg.result.static.hits.length>0){var prod_data='';var resource_data='';var prefix=$('#pathPrefix').val();$.each(msg.result.static.hits,function(idx,dataObj){if(dataObj._source.type==='products'){prod_data+='<li><a href="'+prefix+dataObj._source.url+'.html">'+dataObj._source.title+'</a></li>';}else if(dataObj._source.type==='resources'||dataObj._source.type==='Case Studies'||dataObj._source.type==='White Papers'||dataObj._source.type==='User Guides'||dataObj._source.type==='Articles'||dataObj._source.type==='Tip Sheets'||dataObj._source.type==='Videos'||dataObj._source.type==='Podcasts'||dataObj._source.type==='Quizzes'||dataObj._source.type==='Research Reports'||dataObj._source.type==='Videos & Webinars'){resource_data+='<li><a href="'+prefix+dataObj._source.url+'.html">'+dataObj._source.title+'</a></li>';}});if(resource_data!=null&&resource_data!='undefined'&&resource_data!=''){ul=$('<ul>');ul.append('<a href="'+escapeHTML($("#resourcesearchurl").val())+'?keyword='+encodeURIComponent($("#sitesearchbox").val())+'"><li class="qs-filter" data-filter="organization"><h2>'+viewAllresourcelabelHtml+'</h2></li></a>');ul.append(resource_data);$("#eraResponseJson").append(ul);$("#eraResponseJson").append('<div class="qs-skip container-fluid"><hr /></div>');prodFlag=true;}
if(prod_data!=null&&prod_data!='undefined'&&prod_data!=''){ul=$('<ul>');ul.append('<a href="'+escapeHTML($("#prodsearchurl").val())+'?keyword='+encodeURIComponent($("#sitesearchbox").val())+'" ><li class="qs-filter" data-filter="products"><h2>'+viewAllprodlabelHtml+'</h2></li></a>');ul.append(prod_data);$("#eraResponseJson").append(ul);$("#eraResponseJson").append('<div class="qs-skip container-fluid"><hr /></div>');prodFlag=true;}}
if(msg.result.release.facets!=null&&msg.result.release.facets.source_company!=null&&msg.result.release.facets.source_company.buckets!=null){str=$("#sitesearchbox").val();vanityNewsPath=$("#newsVanityPathURL").val();var org_data='';$.each(msg.result.release.facets.source_company.buckets,function(idx,dataObj){key=dataObj.key;modifiedKey=dataObj.modifiedKey;if((key.toLowerCase().includes(str.toLowerCase()))&&idx<6){org_data+='<li><a href="'+vanityNewsPath+modifiedKey+'/">'+key+'</a></li>';}});if(org_data!=null&&org_data!='undefined'&&org_data!=''){ul=$('<ul>');ul.append('<a href="'+escapeHTML($("#orgsearchurl").val())+'?keyword='+encodeURIComponent($("#sitesearchbox").val())+'"><li class="qs-filter" data-filter="organization"><h2>'+viewAllorglabelHtml+'</h2></li></a>');ul.append(org_data);$("#eraResponseJson").append(ul);$("#eraResponseJson").append('<div class="qs-skip container-fluid"><hr /></div>');orgFlag=true;}}else if(msg.result.release.facets!=null&&msg.result.release.facets.company!=null&&msg.result.release.facets.company.buckets!=null){str=$("#sitesearchbox").val();vanityNewsPath=$("#newsVanityPathURL").val();var org_data='';$.each(msg.result.release.facets.company.buckets,function(idx,dataObj){key=dataObj.key;modifiedKey=dataObj.modifiedKey;var keylink=key.toLowerCase();var num="0";var charCode=["0192","0194","0196","0198","0199","0200","0207","0212","0140","0217","0219","0220","0224","0226","0228","0230","0231","0232","0233","0234","0235","0238","0239","0244","0156","0249","0251","0252"];var flag=true;for(var j=0;j<key.length;j++){for(var i=0;i<charCode.length;i++){if((num.concat(key.charCodeAt(j)))===charCode[i]){var flag=false;var keyEncode=encodeURI(key.charAt(j));keylink=keylink.split(key.charAt(j)).join(keyEncode);keylink=keylink.split("-").join("__");myFunction(flag);break;}}}
function myFunction(flag){return flag;}
if((myFunction(flag))===false){if((key.toLowerCase().includes(str.toLowerCase()))&&idx<6){keylink=keylink.split(" ").join("-");org_data+='<li><a href="'+vanityNewsPath+keylink+'/">'+key+'</a></li>';}}
else{if((key.toLowerCase().includes(str.toLowerCase()))&&idx<6){org_data+='<li><a href="'+vanityNewsPath+modifiedKey+'/">'+key+'</a></li>';}}});if(org_data!=null&&org_data!='undefined'&&org_data!=''){ul=$('<ul>');ul.append('<a href="'+$("#orgsearchurl").val()+'?keyword='+encodeURIComponent($("#sitesearchbox").val())+'"><li class="qs-filter" data-filter="organization"><h2>'+viewAllorglabelHtml+'</h2></li></a>');ul.append(org_data);$("#eraResponseJson").append(ul);$("#eraResponseJson").append('<div class="qs-skip container-fluid"><hr /></div>');orgFlag=true;}}
if(!orgFlag&&!prodFlag&&!newsFlag){$('.qs-no-results').show();}},error:function(XMLHttpRequest,textStatus,errorThrown){$('.qs-no-results').show();console.log('Error in LoadLayout');}});};splitNewReleaseUrl=function(releaseUrl){var newsUrl="";var release=releaseUrl.toString();if(release!=null){var myarray=release.split(',');for(var i=0;i<myarray.length;i++){if(!myarray[i].indexOf("http")==0){newsUrl=myarray[i];console.log("newsUrl------>> "+newsUrl);}}}
return newsUrl;};$('#mobileSiteSearchbox').keypress(function(event){if(event.keyCode==13){var searchtxt=$("#mobileSiteSearchbox").val();var searchUrl=encodeURIComponent($("#mobilesitesearchurl").val());window.location.href=decodeURIComponent(searchUrl)+'?keyword='+encodeURIComponent(searchtxt);return false;}});});